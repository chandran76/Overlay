!function(){function a(a){for(var b=document.createDocumentFragment();child=a.firstChild;)b.appendChild(child);return b}function b(a){var b={added:[],removed:[]};return a.forEach(function(a){b.added=b.added.concat([].slice.call(a.addedNodes)),b.removed=b.removed.concat([].slice.call(a.removedNodes))}),b}function c(a){return a.charAt(0).toUpperCase()+a.slice(1)}function d(a){var b=a.replace(/(\-|_|\.|\s)+(.)?/g,function(a,b,c){return c?c.toUpperCase():""}).replace(/^([A-Z])/,function(a,b,c){return a.toLowerCase()});return c(b)}function e(a){return a?-1===a.indexOf("-"):!1}function f(a){return a?e(a)?-1!==["thead","tbody","tfoot"].indexOf(a)?"HTMLTableSectionElement":"HTML"+d(a)+"Element":d(a):"HTMLElement"}function g(a){var b={created:["created","createdCallback"],attached:["attached","attachedCallback"],detached:["detached","detachedCallback"],attributeChanged:["attributeChanged","attributeChangedCallback"],childListChanged:["childListChanged","childListChangedCallback"]};a.__lifecycle={};for(var c in b)b[c].forEach(function(b){a[b]&&(a.__lifecycle[c]=a[b],delete a[b])});return a}function h(a,b,c){return c=c||[],a&&b&&Object.getOwnPropertyNames(b).forEach(function(d){-1===c.indexOf(d)&&(a[d]=Object.getOwnPropertyDescriptor(b,d))}),a}function i(a){var b=a.split("+").reverse(),c=b[0],d={};return modifiers=b.slice(1),Object.keys(v).forEach(function(a){d[v[a]]=-1!==modifiers.indexOf(a)}),{key:c,modifiers:d}}function j(a,b){return u[b.keyCode]&&u[b.keyCode]===a.key&&k(a,b)}function k(a,b){return Object.keys(a.modifiers).every(function(c){return!!a.modifiers[c]==!!b[c]})}function l(a,b){for(var c=a.split(" "),d=0;d<c.length;d++)if(j(i(c[d]),b))return c[d];return!1}function m(a,b){var c=Object.create(a);return Object.keys(b).forEach(function(a){c[a]=b[a]}),c}function n(a){this.node=a,this.recognizers={},this.resetPointers();var b=this;this.mainHandler=function(a){b.handleEvent(a)},this.setup()}function o(a){var b=a.changed,c=a.firstEvents[a.changedIndex],d=a.lastEvents[a.changedIndex];return{dx:b.clientX-c.clientX,dy:b.clientY-c.clientY,dts:b.ts-c.ts,ddx:b.clientX-d.clientX,ddy:b.clientY-d.clientY,ddts:b.ts-d.ts}}function p(a){var b=o(a),c=b.dx,d=b.dy,e=b.velx=Math.abs(c)/b.dts,f=b.vely=Math.abs(d)/b.dts,g=b.direction=q(c,d);return b.distance=r(c,d,g),b.velocity=s(e,f,g),b}function q(a,b){return a===b?F:Math.abs(a)>=Math.abs(b)?0>a?G:H:0>b?I:J}function r(a,b,c){return c===G||c===H?Math.abs(a):Math.abs(b)}function s(a,b,c){return c===G||c===H?a:b}if(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.PointerEventsPolyfill=b()}(this,function(){"use strict";function a(a,b){b=b||Object.create(null);var c=document.createEvent("Event");c.initEvent(a,b.bubbles||!1,b.cancelable||!1);for(var d,e=2;e<k.length;e++)d=k[e],c[d]=b[d]||l[e];c.buttons=b.buttons||0;var f=0;return f=b.pressure?b.pressure:c.buttons?.5:0,c.x=c.clientX,c.y=c.clientY,c.pointerId=b.pointerId||0,c.width=b.width||0,c.height=b.height||0,c.pressure=f,c.tiltX=b.tiltX||0,c.tiltY=b.tiltY||0,c.pointerType=b.pointerType||"",c.hwTimestamp=b.hwTimestamp||0,c.isPrimary=b.isPrimary||!1,c}function b(){this.array=[],this.size=0}function c(a,b,c,d){this.addCallback=a.bind(d),this.removeCallback=b.bind(d),this.changedCallback=c.bind(d),A&&(this.observer=new A(this.mutationWatcher.bind(this)))}function d(a){return"body /shadow-deep/ "+e(a)}function e(a){return'[touch-action="'+a+'"]'}function f(a){return"{ -ms-touch-action: "+a+"; touch-action: "+a+"; touch-action-delay: none; }"}function g(){if(G){E.forEach(function(a){String(a)===a?(F+=e(a)+f(a)+"\n",H&&(F+=d(a)+f(a)+"\n")):(F+=a.selectors.map(e)+f(a.rule)+"\n",H&&(F+=a.selectors.map(d)+f(a.rule)+"\n"))});var a=document.createElement("style");a.textContent=F,document.head.appendChild(a)}}function h(){if(!window.PointerEvent){if(window.PointerEvent=m,window.navigator.msPointerEnabled){var a=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:a,enumerable:!0}),u.registerSource("ms",da)}else u.registerSource("mouse",P),void 0!==window.ontouchstart&&u.registerSource("touch",_);u.register(document)}}function i(a){if(!u.pointermap.has(a))throw new Error("InvalidPointerId")}function j(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:Z},releasePointerCapture:{value:$}})}var k=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],l=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],m=a,n=window.Map&&window.Map.prototype.forEach,o=n?Map:b;b.prototype={set:function(a,b){return void 0===b?this["delete"](a):(this.has(a)||this.size++,void(this.array[a]=b))},has:function(a){return void 0!==this.array[a]},"delete":function(a){this.has(a)&&(delete this.array[a],this.size--)},get:function(a){return this.array[a]},clear:function(){this.array.length=0,this.size=0},forEach:function(a,b){return this.array.forEach(function(c,d){a.call(b,c,d,this)},this)}};var p=o,q=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],r=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],s="undefined"!=typeof SVGElementInstance,t={pointermap:new p,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(a,b){var c=b,d=c.events;d&&(d.forEach(function(a){c[a]&&(this.eventMap[a]=c[a].bind(c))},this),this.eventSources[a]=c,this.eventSourceList.push(c))},register:function(a){for(var b,c=this.eventSourceList.length,d=0;c>d&&(b=this.eventSourceList[d]);d++)b.register.call(b,a)},unregister:function(a){for(var b,c=this.eventSourceList.length,d=0;c>d&&(b=this.eventSourceList[d]);d++)b.unregister.call(b,a)},contains:function(a,b){try{return a.contains(b)}catch(c){return!1}},down:function(a){a.bubbles=!0,this.fireEvent("pointerdown",a)},move:function(a){a.bubbles=!0,this.fireEvent("pointermove",a)},up:function(a){a.bubbles=!0,this.fireEvent("pointerup",a)},enter:function(a){a.bubbles=!1,this.fireEvent("pointerenter",a)},leave:function(a){a.bubbles=!1,this.fireEvent("pointerleave",a)},over:function(a){a.bubbles=!0,this.fireEvent("pointerover",a)},out:function(a){a.bubbles=!0,this.fireEvent("pointerout",a)},cancel:function(a){a.bubbles=!0,this.fireEvent("pointercancel",a)},leaveOut:function(a){this.out(a),this.contains(a.target,a.relatedTarget)||this.leave(a)},enterOver:function(a){this.over(a),this.contains(a.target,a.relatedTarget)||this.enter(a)},eventHandler:function(a){if(!a._handledByPE){var b=a.type,c=this.eventMap&&this.eventMap[b];c&&c(a),a._handledByPE=!0}},listen:function(a,b){b.forEach(function(b){this.addEvent(a,b)},this)},unlisten:function(a,b){b.forEach(function(b){this.removeEvent(a,b)},this)},addEvent:function(a,b){a.addEventListener(b,this.boundHandler)},removeEvent:function(a,b){a.removeEventListener(b,this.boundHandler)},makeEvent:function(a,b){this.captureInfo[b.pointerId]&&(b.relatedTarget=null);var c=new m(a,b);return b.preventDefault&&(c.preventDefault=b.preventDefault),c._target=c._target||b.target,c},fireEvent:function(a,b){var c=this.makeEvent(a,b);return this.dispatchEvent(c)},cloneEvent:function(a){for(var b,c=Object.create(null),d=0;d<q.length;d++)b=q[d],c[b]=a[b]||r[d],!s||"target"!==b&&"relatedTarget"!==b||c[b]instanceof SVGElementInstance&&(c[b]=c[b].correspondingUseElement);return a.preventDefault&&(c.preventDefault=function(){a.preventDefault()}),c},getTarget:function(a){return this.captureInfo[a.pointerId]||a._target},setCapture:function(a,b){this.captureInfo[a]&&this.releaseCapture(a),this.captureInfo[a]=b;var c=document.createEvent("Event");c.initEvent("gotpointercapture",!0,!1),c.pointerId=a,this.implicitRelease=this.releaseCapture.bind(this,a),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease),c._target=b,this.asyncDispatchEvent(c)},releaseCapture:function(a){var b=this.captureInfo[a];if(b){var c=document.createEvent("Event");c.initEvent("lostpointercapture",!0,!1),c.pointerId=a,this.captureInfo[a]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease),c._target=b,this.asyncDispatchEvent(c)}},dispatchEvent:function(a){var b=this.getTarget(a);return b?b.dispatchEvent(a):void 0},asyncDispatchEvent:function(a){requestAnimationFrame(this.dispatchEvent.bind(this,a))}};t.boundHandler=t.eventHandler.bind(t);var u=t,v={shadow:function(a){return a?a.shadowRoot||a.webkitShadowRoot:void 0},canTarget:function(a){return a&&Boolean(a.elementFromPoint)},targetingShadow:function(a){var b=this.shadow(a);return this.canTarget(b)?b:void 0},olderShadow:function(a){var b=a.olderShadowRoot;if(!b){var c=a.querySelector("shadow");c&&(b=c.olderShadowRoot)}return b},allShadows:function(a){for(var b=[],c=this.shadow(a);c;)b.push(c),c=this.olderShadow(c);return b},searchRoot:function(a,b,c){if(a){var d,e,f=a.elementFromPoint(b,c);for(e=this.targetingShadow(f);e;){if(d=e.elementFromPoint(b,c)){var g=this.targetingShadow(d);return this.searchRoot(g,b,c)||d}e=this.olderShadow(e)}return f}},owner:function(a){for(var b=a;b.parentNode;)b=b.parentNode;return b.nodeType!==Node.DOCUMENT_NODE&&b.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(b=document),b},findTarget:function(a){var b=a.clientX,c=a.clientY,d=this.owner(a.target);return d.elementFromPoint(b,c)||(d=document),this.searchRoot(d,b,c)}},w=Array.prototype.forEach.call.bind(Array.prototype.forEach),x=Array.prototype.map.call.bind(Array.prototype.map),y=Array.prototype.slice.call.bind(Array.prototype.slice),z=Array.prototype.filter.call.bind(Array.prototype.filter),A=window.MutationObserver||window.WebKitMutationObserver,B="[touch-action]",C={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};c.prototype={watchSubtree:function(a){this.observer&&v.canTarget(a)&&this.observer.observe(a,C)},enableOnSubtree:function(a){this.watchSubtree(a),a===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(a)},installNewSubtree:function(a){w(this.findElements(a),this.addElement,this)},findElements:function(a){return a.querySelectorAll?a.querySelectorAll(B):[]},removeElement:function(a){this.removeCallback(a)},addElement:function(a){this.addCallback(a)},elementChanged:function(a,b){this.changedCallback(a,b)},concatLists:function(a,b){return a.concat(y(b))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(a){return a.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(a){var b=x(a,this.findElements,this);return b.push(z(a,this.isElement)),b.reduce(this.concatLists,[])},mutationWatcher:function(a){a.forEach(this.mutationHandler,this)},mutationHandler:function(a){if("childList"===a.type){var b=this.flattenMutationTree(a.addedNodes);b.forEach(this.addElement,this);var c=this.flattenMutationTree(a.removedNodes);c.forEach(this.removeElement,this)}else"attributes"===a.type&&this.elementChanged(a.target,a.oldValue)}};var D=c,E=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],F="",G=window.PointerEvent||window.MSPointerEvent,H=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,I=u.pointermap,J=25,K=[1,4,2,8,16],L=!1;try{L=1===new MouseEvent("test",{buttons:1}).buttons}catch(M){}var N,O={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(a){u.listen(a,this.events)},unregister:function(a){u.unlisten(a,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(a){for(var b,c=this.lastTouches,d=a.clientX,e=a.clientY,f=0,g=c.length;g>f&&(b=c[f]);f++){var h=Math.abs(d-b.x),i=Math.abs(e-b.y);if(J>=h&&J>=i)return!0}},prepareEvent:function(a){var b=u.cloneEvent(a),c=b.preventDefault;return b.preventDefault=function(){a.preventDefault(),c()},b.pointerId=this.POINTER_ID,b.isPrimary=!0,b.pointerType=this.POINTER_TYPE,b},prepareButtonsForMove:function(a,b){var c=I.get(this.POINTER_ID);a.buttons=c?c.buttons:0,b.buttons=a.buttons},mousedown:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=I.get(this.POINTER_ID),c=this.prepareEvent(a);L||(c.buttons=K[c.button],b&&(c.buttons|=b.buttons),a.buttons=c.buttons),I.set(this.POINTER_ID,a),b?u.move(c):u.down(c)}},mousemove:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);L||this.prepareButtonsForMove(b,a),u.move(b)}},mouseup:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=I.get(this.POINTER_ID),c=this.prepareEvent(a);if(!L){var d=K[c.button];c.buttons=b?b.buttons&~d:0,a.buttons=c.buttons}I.set(this.POINTER_ID,a),0===c.buttons||c.buttons===K[c.button]?(this.cleanupMouse(),u.up(c)):u.move(c)}},mouseover:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);L||this.prepareButtonsForMove(b,a),u.enterOver(b)}},mouseout:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);L||this.prepareButtonsForMove(b,a),u.leaveOut(b)}},cancel:function(a){var b=this.prepareEvent(a);u.cancel(b),this.cleanupMouse()},cleanupMouse:function(){I["delete"](this.POINTER_ID)}},P=O,Q=u.captureInfo,R=v.findTarget.bind(v),S=v.allShadows.bind(v),T=u.pointermap,U=2500,V=200,W="touch-action",X=!1,Y={events:["touchstart","touchmove","touchend","touchcancel"],register:function(a){X?u.listen(a,this.events):N.enableOnSubtree(a)},unregister:function(a){X&&u.unlisten(a,this.events)},elementAdded:function(a){var b=a.getAttribute(W),c=this.touchActionToScrollType(b);c&&(a._scrollType=c,u.listen(a,this.events),S(a).forEach(function(a){a._scrollType=c,u.listen(a,this.events)},this))},elementRemoved:function(a){a._scrollType=void 0,u.unlisten(a,this.events),S(a).forEach(function(a){a._scrollType=void 0,u.unlisten(a,this.events)},this)},elementChanged:function(a,b){var c=a.getAttribute(W),d=this.touchActionToScrollType(c),e=this.touchActionToScrollType(b);d&&e?(a._scrollType=d,S(a).forEach(function(a){a._scrollType=d},this)):e?this.elementRemoved(a):d&&this.elementAdded(a)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(a){var b=a,c=this.scrollTypes;return"none"===b?"none":b===c.XSCROLLER?"X":b===c.YSCROLLER?"Y":c.SCROLLER.exec(b)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(a){return this.firstTouch===a.identifier},setPrimaryTouch:function(a){(0===T.size||1===T.size&&T.has(1))&&(this.firstTouch=a.identifier,this.firstXY={X:a.clientX,Y:a.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(a){a.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var a=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(a,V)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(a){var b=0;return("touchstart"===a||"touchmove"===a)&&(b=1),b},touchToPointer:function(a){var b=this.currentTouchEvent,c=u.cloneEvent(a),d=c.pointerId=a.identifier+2;c.target=Q[d]||R(c),c.bubbles=!0,c.cancelable=!0,c.detail=this.clickCount,c.button=0,c.buttons=this.typeToButtons(b.type),c.width=a.radiusX||a.webkitRadiusX||0,c.height=a.radiusY||a.webkitRadiusY||0,c.pressure=a.force||a.webkitForce||.5,c.isPrimary=this.isPrimaryTouch(a),c.pointerType=this.POINTER_TYPE;var e=this;return c.preventDefault=function(){e.scrolling=!1,e.firstXY=null,b.preventDefault()},c},processTouches:function(a,b){var c=a.changedTouches;this.currentTouchEvent=a;for(var d,e=0;e<c.length;e++)d=c[e],b.call(this,this.touchToPointer(d))},shouldScroll:function(a){if(this.firstXY){var b,c=a.currentTarget._scrollType;if("none"===c)b=!1;else if("XY"===c)b=!0;else{var d=a.changedTouches[0],e=c,f="Y"===c?"X":"Y",g=Math.abs(d["client"+e]-this.firstXY[e]),h=Math.abs(d["client"+f]-this.firstXY[f]);b=g>=h}return this.firstXY=null,b}},findTouch:function(a,b){for(var c,d=0,e=a.length;e>d&&(c=a[d]);d++)if(c.identifier===b)return!0},vacuumTouches:function(a){var b=a.touches;if(T.size>=b.length){var c=[];T.forEach(function(a,d){if(1!==d&&!this.findTouch(b,d-2)){var e=a.out;c.push(e)}},this),c.forEach(this.cancelOut,this)}},touchstart:function(a){this.vacuumTouches(a),this.setPrimaryTouch(a.changedTouches[0]),this.dedupSynthMouse(a),this.scrolling||(this.clickCount++,this.processTouches(a,this.overDown))},overDown:function(a){T.set(a.pointerId,{target:a.target,out:a,outTarget:a.target}),u.over(a),u.enter(a),u.down(a)},touchmove:function(a){this.scrolling||(this.shouldScroll(a)?(this.scrolling=!0,this.touchcancel(a)):(a.preventDefault(),this.processTouches(a,this.moveOverOut)))},moveOverOut:function(a){var b=a,c=T.get(b.pointerId);if(c){var d=c.out,e=c.outTarget;u.move(b),d&&e!==b.target&&(d.relatedTarget=b.target,b.relatedTarget=e,d.target=e,b.target?(u.leaveOut(d),u.enterOver(b)):(b.target=e,b.relatedTarget=null,this.cancelOut(b))),c.out=b,c.outTarget=b.target}},touchend:function(a){this.dedupSynthMouse(a),this.processTouches(a,this.upOut)},upOut:function(a){this.scrolling||(u.up(a),u.out(a),u.leave(a)),this.cleanUpPointer(a)},touchcancel:function(a){this.processTouches(a,this.cancelOut)},cancelOut:function(a){u.cancel(a),u.out(a),u.leave(a),this.cleanUpPointer(a)},cleanUpPointer:function(a){T["delete"](a.pointerId),this.removePrimaryPointer(a)},dedupSynthMouse:function(a){var b=P.lastTouches,c=a.changedTouches[0];if(this.isPrimaryTouch(c)){var d={x:c.clientX,y:c.clientY};b.push(d);var e=function(a,b){var c=a.indexOf(b);c>-1&&a.splice(c,1)}.bind(null,b,d);setTimeout(e,U)}}};X||(N=new D(Y.elementAdded,Y.elementRemoved,Y.elementChanged,Y));var Z,$,_=Y,aa=u.pointermap,ba=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,ca={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(a){u.listen(a,this.events)},unregister:function(a){u.unlisten(a,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(a){var b=a;return ba&&(b=u.cloneEvent(a),b.pointerType=this.POINTER_TYPES[a.pointerType]),b},cleanup:function(a){aa["delete"](a)},MSPointerDown:function(a){aa.set(a.pointerId,a);var b=this.prepareEvent(a);u.down(b)},MSPointerMove:function(a){var b=this.prepareEvent(a);u.move(b)},MSPointerUp:function(a){var b=this.prepareEvent(a);u.up(b),this.cleanup(a.pointerId)},MSPointerOut:function(a){var b=this.prepareEvent(a);u.leaveOut(b)},MSPointerOver:function(a){var b=this.prepareEvent(a);u.enterOver(b)},MSPointerCancel:function(a){var b=this.prepareEvent(a);u.cancel(b),this.cleanup(a.pointerId)},MSLostPointerCapture:function(a){var b=u.makeEvent("lostpointercapture",a);u.dispatchEvent(b)},MSGotPointerCapture:function(a){var b=u.makeEvent("gotpointercapture",a);u.dispatchEvent(b)}},da=ca,ea=window.navigator;ea.msPointerEnabled?(Z=function(a){i(a),this.msSetPointerCapture(a)},$=function(a){i(a),this.msReleasePointerCapture(a)}):(Z=function(a){i(a),u.setCapture(a,this)},$=function(a){i(a),u.releaseCapture(a,this)}),g(),h(),j();var fa={dispatcher:u,Installer:D,PointerEvent:m,PointerMap:p,targetFinding:v};return fa}),!window.WebComponents)throw"Bosonic runtime needs the WebComponents polyfills to be loaded first.";window.Bosonic||(window.Bosonic={}),Bosonic.Base={createdCallback:function(){if(this.__template){this.createShadowRoot();var c=this.__template.content?this.__template.content:a(this.__template);WebComponents.flags.shadow!==!1&&WebComponents.ShadowCSS.shimStyling(c,this.__elementName),this.shadowRoot.appendChild(document.importNode(c,!0))}var d=this.__lifecycle.childListChanged;if(d){var e=this,f=new MutationObserver(function(a){var c=b(a);d.call(e,c.removed,c.added,a)});f.observe(this,{childList:!0,subtree:!0,characterData:!0})}this.__callMixins("created"),this.classList.add("resolved");var g=this.__lifecycle.created;return g?g.apply(this,arguments):null},attachedCallback:function(){this.__callMixins("attached");var a=this.__lifecycle.attached;return a?a.apply(this,arguments):null},detachedCallback:function(){this.__callMixins("detached");var a=this.__lifecycle.detached;return a?a.apply(this,arguments):null},attributeChangedCallback:function(a,b,c){this.__attributes&&(0===a.indexOf("data-")&&(a=a.substr(5)),-1!==this.__attributes.indexOf(a)&&this[a+"Changed"]&&this[a+"Changed"].call(this,b,c));var d=this.__lifecycle.attributeChanged;return d?d.apply(this,arguments):null},__callMixins:function(a,b){this.__mixins.forEach(function(c){c[a]&&(b?c[a].apply(this,b):c[a].call(this))},this)}},Bosonic.register=function(a){var b=document._currentScript,c=b&&b.parentNode?b.parentNode:null;if(!c||"ELEMENT"!==c.tagName.toUpperCase())throw"Surrounding <element> tag could not be found.";var i=c.getAttribute("name");if(!i)throw"Element name could not be inferred.";var j=c.getAttribute("attributes"),k=c.getAttribute("extends"),l=e(k),m=d(i),n=f(k),o=b&&b.parentNode?b.parentNode.querySelector("template"):null;a=g(a),a.__elementName=i,o&&(a.__template=o),j&&(a.__attributes=j.split(" "));var p=h({},Bosonic.Base),q=[Bosonic.Dom,Bosonic.Events,Bosonic.Gestures,Bosonic.A11y,Bosonic.CustomAttributes],r=q;a.mixins&&(r=r.concat(a.mixins)),r.forEach(function(a){p=h(p,a,["created","attached","detached"])}),a.__mixins=r,p=h(p,a);var s={prototype:Object.create(window[n].prototype,p)};k&&l&&(s["extends"]=k),window[m]=document.registerElement(i,s)};var t="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",u={9:"tab",13:"enter",27:"esc",33:"pageup",34:"pagedown",35:"end",36:"home",32:"space",37:"left",38:"up",39:"right",40:"down",46:"del",106:"*"},v={shift:"shiftKey",ctrl:"ctrlKey",alt:"altKey",meta:"metaKey"};Bosonic.A11y={created:function(){this.keyBindings&&this._setupKeyListener(this)},detached:function(){this.keyBindings&&this._removeKeyListener(this)},getFocusableElements:function(a){return a=a||this,a.querySelectorAll(t)},getFirstFocusableElement:function(a){return a=a||this,a.querySelector(t)},_setupKeyListener:function(a){var b=function(b){for(var c in a.keyBindings){var d=l(c,b);if(d&&!b.defaultPrevented){var e=a.keyBindings[c];return void a[e](b,d)}}};a.__keyListener=b,this._listen(a,"keydown",b)},_removeKeyListener:function(a){this._unlisten(a,"keydown",a.__keyListener)}},Bosonic.CustomAttributes={hasCustomAttribute:function(a){return this.hasAttribute(a)||this._hasPrefixedAttribute(a)},getCustomAttribute:function(a){return this.getAttribute(this._getRealAttribute(a))},setCustomAttribute:function(a,b){this.setAttribute(this._getRealAttribute(a),b)},removeCustomAttribute:function(a){this.removeAttribute(this._getRealAttribute(a))},toggleCustomAttribute:function(a,b){1==arguments.length&&(b=!this.hasCustomAttribute(a)),b?this.setCustomAttribute(a,""):this.removeCustomAttribute(a)},_hasPrefixedAttribute:function(a){return this.hasAttribute("data-"+a)},_getRealAttribute:function(a){return this._hasPrefixedAttribute(a)?"data-"+a:a}},Bosonic.Dom={created:function(){if(this.hostAttributes)for(var a in this.hostAttributes)this.setAttribute(a,this.hostAttributes[a])},toggleClass:function(a,b,c){c=c||this,1==arguments.length&&(b=!c.classList.contains(a)),b?c.classList.add(a):c.classList.remove(a)},toggleAttribute:function(a,b,c){c=c||this,1==arguments.length&&(b=!c.hasAttribute(a)),b?c.setAttribute(a,""):c.removeAttribute(a)},toggleStateAttribute:function(a,b,c){c=c||this,1==arguments.length&&(b=!c.hasAttribute(a)||"false"==c.getAttribute(a)),b?c.setAttribute(a,"true"):c.setAttribute(a,"false")},async:function(a,b){var c=this;return setTimeout(function(){a.call(c)},b)},cancelAsync:function(a){clearTimeout(a)}};var w=10,x=function(){var a=document.createElement("div");return void 0!==a.style.WebkitTransition?"webkitTransitionEnd":"transitionend"}();Bosonic.Events={created:function(){this.shadowRoot&&PointerEventsPolyfill.dispatcher.register(this.shadowRoot);for(var a in this.listeners)this.listen(this,a,this.listeners[a])},detached:function(){for(var a in this.listeners)this.unlisten(this,a,this.listeners[a])},fire:function(a,b,c){b=b||{},c=c||{};var d=new CustomEvent(a,{bubbles:c.bubbles===!1?!1:!0,cancelable:c.cancelable===!0?!0:!1,detail:b}),e=c.node||this;return e.dispatchEvent(d),d},listenOnce:function(a,b,c,d){var e=this,f=function(){c.apply(e,d),a.removeEventListener(b,f,!1)};a.addEventListener(b,f,!1)},transition:function(a,b,c){var d=this,e=function(){c.call(d,a)};this.listenOnce(a,x,e),b.call(d,a)},listen:function(a,b,c){var d=this._findListener(this,a,b,c);d||(d=this._registerListener(this,a,b,c)),d.deps&&Object.keys(d.deps).forEach(function(b){this._listen(a,b,d.deps[b])},this),this._listen(a,b,d.handler)},unlisten:function(a,b,c){var d=this._findListener(this,a,b,c);d&&(d.deps&&Object.keys(d.deps).forEach(function(b){this._unlisten(a,b,d.deps[b])},this),this._unlisten(a,b,d.handler))},_listen:function(a,b,c){a.addEventListener(b,c)},_unlisten:function(a,b,c){a.removeEventListener(b,c)},_findListener:function(a,b,c,d){return this._getListener(a,b,this._getListenerKey(c,d))},_getListener:function(a,b,c){if(a.__listeners&&a.__listeners[c]){var d=a.__listeners[c],e=d.length;if(1===e)return d[0];for(var f=0;e>f;f++)if(d[f].node===b)return d[f]}},_registerListener:function(a,b,c,d){var e=this._getListenerKey(c,d),f=this._prepareListener(a,b,c,d);return this._setListener(a,b,e,f),f},_prepareListener:function(a,b,c,d){if(!a[d])throw"Event handler method `"+d+"` is not defined";var e={node:b,handler:function(b){a[d](b)}};if(this.customEvents[c]){var f={},g=this.customEvents[c];e.deps={},g.deps.forEach(function(a){var b=g[a].bind(this,f);e.deps[a]=b})}return e},_setListener:function(a,b,c,d){a.__listeners||(a.__listeners={}),a.__listeners[c]||(a.__listeners[c]=[]),a.__listeners[c].push(d)},_getListenerKey:function(a,b){return a+":"+b},customEvents:{tap:{deps:["pointerdown","pointerup"],pointerdown:function(a,b){a.x=b.clientX,a.y=b.clientY},pointerup:function(a,b){0===b.button&&Math.abs(a.x-b.clientX)<w&&Math.abs(a.y-b.clientY)<w&&Bosonic.Events.fire("tap",a,{node:b.target})}}}};var y="__bosonicGestures",w=10,z="possible",A="start",B="track",C="end",D=C,E="fail",F="none",G="left",H="right",I="up",J="down",K={init:function(a,b){this.state="possible",this.name=a,this.manager=b},transitionTo:function(a,b){this.state=a,b=b||{},b.state=a,this.shouldFire(a)&&this.manager.tryFire(this.name,b)},shouldFire:function(a){return-1!==[D,A,B,C].indexOf(a)}},L=m(K,{maxPointers:1,down:function(a){a.ids.length===this.maxPointers?this.transitionTo(A):this.transitionTo(E)},move:function(a){(this.state===A||this.state===B)&&this.transitionTo(B,o(a))},up:function(a){if(this.state===B){var b=p(a);this.transitionTo(C,b)}else this.transitionTo(E)}}),M=m(K,{maxPointers:1,minDistance:10,minVelocity:.3,down:function(a){a.ids.length===this.maxPointers?this.transitionTo(z):this.transitionTo(E)},move:function(a){},up:function(a){var b=p(a);this.state!==E&&(this.direction&&b.direction===this.direction||b.direction!==F)&&b.distance>this.minDistance&&b.velocity>this.minVelocity?this.transitionTo(D,b):this.transitionTo(E)}}),N=m(M,{direction:G}),O=m(M,{direction:H}),P=m(M,{direction:I}),Q=m(M,{direction:J}),R=m(K,{maxPointers:1,minDistance:10,down:function(a){a.ids.length===this.maxPointers?this.transitionTo(z):this.transitionTo(E)},move:function(a){var b=p(a);this.state===z&&b.distance>this.minDistance?this.transitionTo(A,b):(this.state===A||this.state===B)&&this.transitionTo(B,b)},up:function(a){if(this.state===B){var b=p(a);this.transitionTo(C,b)}else this.transitionTo(E)}}),S=m(R,{direction:G}),T=m(R,{direction:H}),U=m(R,{direction:I}),V=m(R,{direction:J});Bosonic.Gestures={recognizers:{track:L,pan:R,panLeft:S,panRight:T,panUp:U,panDown:V,swipe:M,swipeLeft:N,swipeRight:O,swipeUp:P,swipeDown:Q},_listen:function(a,b,c){this.recognizers[b]&&this.setupGesture(a,b),a.addEventListener(b,c)},_unlisten:function(a,b,c){this.recognizers[b]&&this.teardownGesture(a,b),a.removeEventListener(b,c)},setupGesture:function(a,b){a[y]||(a[y]=new n(a)),a[y].listen(b)},teardownGesture:function(a,b){var c=a[y];c.unlisten(b)}},n.prototype={setup:function(){this.node.setAttribute("touch-action","none"),this.node.addEventListener("pointerdown",this.mainHandler),document.addEventListener("pointermove",this.mainHandler),document.addEventListener("pointerup",this.mainHandler)},teardown:function(){this.node.removeAttribute("touch-action","none"),this.node.removeEventListener("pointerdown",this.mainHandler),document.removeEventListener("pointermove",this.mainHandler),document.removeEventListener("pointerup",this.mainHandler)},listen:function(a){var b=Object.create(Bosonic.Gestures.recognizers[a]);b.init(a,this),this.recognizers[a]=b},unlisten:function(a){delete this.recognizers[a]},handleEvent:function(a){this.updatePointers(a),this.pointers.changed&&(this.recognize(),this.persistLastEvent())},persistLastEvent:function(){this.pointers.lastEvents[this.pointers.changedIndex]=this.pointers.changed,this.pointers.changed=null,this.pointers.changedIndex=null},updatePointers:function(a){var b;if(a.ts=Date.now(),"pointerdown"!==a.type||0!==a.button&&"mouse"===a.pointerType){if("pointerup"===a.type||"pointermove"===a.type){var b=this.pointers.ids.indexOf(a.pointerId);if(0>b)return;"pointerup"===a.type&&this.pointers.ids.splice(b,1)}}else{var c=this.pointers.ids.length;if(0===c)this.resetPointers();else if(2===c)return;var b=this.pointers.ids.push(a.pointerId)-1;this.pointers.firstEvents.push(a)}this.pointers.changed=a,this.pointers.changedIndex=b},recognize:function(){Object.keys(this.recognizers).forEach(function(a){var b=this.recognizers[a];switch(this.pointers.changed.type){case"pointerdown":b.down(this.pointers);break;case"pointermove":b.move(this.pointers);break;case"pointerup":b.up(this.pointers)}},this)},resetPointers:function(){this.pointers={ids:[],firstEvents:[],lastEvents:[]}},tryFire:function(a,b){var c=b||{};this.fire(this.node,a,c,this.pointers.changed)},fire:function(a,b,c,d){d&&(c.originalEvent=d);var e=Bosonic.Events.fire(b,c,{bubbles:!0,cancelable:!0,node:a});e.defaultPrevented&&d&&d.preventDefault&&(d.preventDefault(),d.stopImmediatePropagation())}},Bosonic.Selection={get selectedItemIndex(){return this.hasAttribute("selected")?Number(this.getAttribute("selected")):null},get selectedItem(){return this.getItem(this.selectedItemIndex)},select:function(a){a!==this.selectedItemIndex&&this.setAttribute("selected",a)},unselect:function(){this.hasAttribute("selected")&&this.removeAttribute("selected")},selectFirst:function(){this.getItemCount()>0&&this.select(0)},selectLast:function(){this.getItemCount()>0&&this.select(this.getItemCount()-1)},selectNextItem:function(){return null===this.selectedItemIndex?void this.selectFirst():void(this.selectedItemIndex<this.getItemCount()-1&&this.select(this.selectedItemIndex+1))},selectPreviousItem:function(){return null===this.selectedItemIndex?void this.selectLast():void(this.selectedItemIndex>0&&this.select(this.selectedItemIndex-1))},getItem:function(a){return this.getItems()[a]||null},getItemCount:function(){return this.getItems().length},getItems:function(){var a=this.getAttribute("target"),b=a?this.querySelectorAll(a):this.children;return Array.prototype.slice.call(b,0)}}}();